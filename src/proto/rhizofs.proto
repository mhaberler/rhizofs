
package rhizofs;

message Version {
    required int32 major = 1;
    required int32 minor = 2;
}


enum RequestType {
    STAT = 0;
    MKDIR = 1;
    UNKNOWN = 2;
    PING = 3;       // ping the server - does not perform any filesystem actions
    READDIR = 4;
    INVALID = 5;
}

enum ErrorType {
    NONE = 0;
    INVALID_REQUEST = 1;
    UNSERIALIZABLE_REQUEST = 2;
    INTERNAL = 3;
}


message Stat {
    required int64 st_size = 1;    
    required int32 st_mode = 2; // unsigned int
}


message Request {
    required RequestType requesttype = 1;
    required Version version = 2;

    // the share to connect to
    required string endpoint = 3;

    optional string path = 4;

    // READDIR
}


message Response {
    required RequestType requesttype = 1;
    required Version version = 2;

    required ErrorType errortype = 3 [default = NONE];

    // READDIR
    repeated string directory_entry = 4;
}
